{% extends "base.html" %}

{% block content %}
<!-- COMPACT HOMEPAGE - MOBILE FIRST, EVERYTHING VISIBLE -->
<div class="compact-homepage">
    
    <!-- MAIN CONTAINER -->
    <div class="compact-container">
        
        <!-- Header with Two Buttons Side by Side -->
        <div class="compact-header">
            <div class="header-buttons">
                <button class="btn-login" id="google-signin-btn">
                    <span class="btn-icon">G</span> Log in with Google
                </button>
                <button class="btn-staff" id="staff-signin-btn">
                    Staff Log In
                </button>
            </div>
        </div>
        
        <!-- Compact Navigation -->
        <div class="compact-nav">
            <nav>
                <a href="/features">Features</a>
                <a href="/story">Our Story</a>
                <a href="/pricing">Pricing</a>
                <a href="/testimonials">Success Stories</a>
            </nav>
        </div>
        
        <!-- Main Content -->
        <div class="compact-content">
            <!-- Logo on left -->
            <div class="compact-logo">
                <div class="logo-pulse" id="logoPulse">SK</div>
            </div>
            
            <!-- Content on right -->
            <div class="compact-text">
                <h1>Superkeeper</h1>
                <p class="tagline">Inventory for small shops</p>
                
                <div class="benefits-compact">
                    <div class="benefit">
                        <span>‚úì</span> Track stock on phone
                    </div>
                    <div class="benefit">
                        <span>‚úì</span> Manage staff easily
                    </div>
                    <div class="benefit">
                        <span>‚úì</span> See sales in real-time
                    </div>
                </div>
                
                <!-- TOUR SECTION - One-click demo login -->
                <div class="tour-section-compact">
                    <p class="tour-title">üîç Want to see inside first?</p>
                    <button id="tour-demo-btn" class="tour-btn">
                        üëÜ Try Demo Shop
                    </button>
                    <p class="tour-note">No signup ‚Ä¢ Instant access</p>
                </div>
                
                <!-- Main CTA Button -->
                <button class="btn-main-cta" id="google-signin-btn-mobile">
                    Start Free Forever
                </button>
                
                <p class="note">No credit card ‚Ä¢ Setup in 5 minutes</p>
            </div>
        </div>
    </div>
</div>

<!-- Staff Login Container (for staffLogin.js) -->
<div id="staff-login-container" style="display: none;"></div>

<!-- CONSTRUCTION BANNER -->
<div class="construction-banner">
    <div class="construction-content">
        <span class="construction-icon">üöß</span>
        <span class="construction-text">Website Under Construction - Actively Building!</span>
        <span class="construction-icon">üèóÔ∏è</span>
    </div>
</div>
{% endblock %}

{% block scripts %}
<!-- IMPORT LOGIN FILES FIRST -->
<script type="module" src="{{ url_for('static', filename='js/login.js') }}"></script>
<script type="module" src="{{ url_for('static', filename='js/staffLogin.js') }}"></script>
<!-- IMPORT TOUR LOGIN -->
<script type="module" src="{{ url_for('static', filename='js/tourLogin.js') }}"></script>

<!-- STYLING AND HANDLERS -->
<script type="module">
// Import tour login function
import { handleDemoLogin } from "{{ url_for('static', filename='js/tourLogin.js') }}";

// Apply styles after DOM is ready
document.addEventListener("DOMContentLoaded", function() {
    console.log("üîç Homepage loaded - applying styles");
    
    // Get button references
    const googleBtn = document.getElementById('google-signin-btn');
    const staffBtn = document.getElementById('staff-signin-btn');
    const mobileBtn = document.getElementById('google-signin-btn-mobile');
    const tourBtn = document.getElementById('tour-demo-btn');
    
    // Style Google button
    if (googleBtn) {
        googleBtn.style.cssText = `
            flex: 1;
            padding: 10px 4px;
            border-radius: 40px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            color: #333;
            border: 1px solid #ddd;
            gap: 4px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.05);
        `;
        
        // Add G icon if not present
        if (!googleBtn.querySelector('.btn-icon')) {
            const iconSpan = document.createElement('span');
            iconSpan.className = 'btn-icon';
            iconSpan.style.cssText = `
                background: #4285F4;
                color: white;
                width: 20px;
                height: 20px;
                border-radius: 50%;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                font-size: 12px;
                font-weight: bold;
                margin-right: 4px;
            `;
            iconSpan.textContent = 'G';
            googleBtn.prepend(iconSpan);
        }
    }
    
    // Style staff button - preserve original click handler
    if (staffBtn) {
        staffBtn.style.cssText = `
            flex: 1;
            padding: 10px 4px;
            border-radius: 40px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            box-shadow: 0 4px 10px rgba(102,126,234,0.3);
        `;
        
        console.log("‚úÖ Staff button styled - original click handler preserved");
    }
    
    // TOUR BUTTON - One-click demo login
    if (tourBtn) {
        tourBtn.addEventListener('click', async function(e) {
            e.preventDefault();
            console.log("üîç Tour button clicked - starting demo login");
            
            // Show loading state
            const originalText = this.textContent;
            this.textContent = "‚è≥ Loading demo...";
            this.disabled = true;
            
            try {
                // Call the imported demo login function
                await handleDemoLogin();
                // If successful, redirect happens in the function
                
            } catch (error) {
                console.error("‚ùå Demo login failed:", error);
                
                // Reset button if login failed (if not redirected)
                setTimeout(() => {
                    this.textContent = originalText;
                    this.disabled = false;
                }, 2000);
            }
        });
        
        // Hover effect
        tourBtn.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-1px)';
            this.style.boxShadow = '0 4px 12px rgba(255,193,7,0.4)';
        });
        
        tourBtn.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
            this.style.boxShadow = '0 2px 6px rgba(255,193,7,0.3)';
        });
    }

    // Mobile button - triggers Google login
    if (mobileBtn && googleBtn) {
        mobileBtn.addEventListener('click', function() {
            googleBtn.click();
        });
    }
    
    // Logo animation
    let logo = document.getElementById('logoPulse');
    if (logo) {
        let beatCount = 0;
        const logos = ['SK', 'üì±', 'üì¶', 'üí∞', 'üë•', 'üìä', '‚úì', 'üöÄ'];
        setInterval(() => {
            logo.textContent = logos[beatCount % logos.length];
            logo.style.transform = 'scale(1.05)';
            setTimeout(() => logo.style.transform = 'scale(1)', 100);
            beatCount++;
        }, 857);
    }
});
</script>

<!-- Keep all your existing styles - they're perfect! -->
<style>
/* ============================================= */
/* MOBILE FIRST - PERFECT FIT HOMEPAGE          */
/* ============================================= */

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #f8fafc;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* MAIN CONTENT */
main {
    flex: 1;
    overflow-y: auto;
    padding: 0;
    display: flex;
    flex-direction: column;
}

/* HOMEPAGE CONTAINER */
.compact-homepage {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 8px;
    background: white;
}

/* MAIN CARD */
.compact-container {
    width: 100%;
    max-width: 500px;
    margin: 0 auto;
    background: white;
    border-radius: 24px;
    padding: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
    border: 1px solid #f1f5f9;
}

/* HEADER WITH TWO BUTTONS */
.compact-header {
    margin-bottom: 12px;
}

.header-buttons {
    display: flex;
    gap: 8px;
    justify-content: center;
    width: 100%;
}

/* NAVIGATION */
.compact-nav {
    margin-bottom: 12px;
    padding-bottom: 8px;
    border-bottom: 1px solid #f1f5f9;
}

.compact-nav nav {
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
}

.compact-nav a {
    color: #64748b;
    text-decoration: none;
    font-size: 12px;
    font-weight: 500;
    padding: 4px 0;
}

.compact-nav a:hover {
    color: #3b82f6;
}

/* CONTENT LAYOUT */
.compact-content {
    display: flex;
    gap: 12px;
    align-items: center;
}

/* LOGO */
.compact-logo {
    flex: 0 0 auto;
    width: 90px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.logo-pulse {
    font-size: 3.5rem;
    font-weight: 800;
    color: #3b82f6;
    transition: transform 0.2s;
    animation: gentle-pulse 1.5s infinite;
}

@keyframes gentle-pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.9; transform: scale(1.02); }
}

/* TEXT CONTENT */
.compact-text {
    flex: 1;
    min-width: 0;
}

.compact-text h1 {
    font-size: 1.6rem;
    font-weight: 700;
    color: #0f172a;
    margin: 0 0 2px 0;
    line-height: 1.2;
}

.compact-text .tagline {
    font-size: 0.8rem;
    color: #64748b;
    margin-bottom: 8px;
}

/* BENEFITS */
.benefits-compact {
    margin-bottom: 8px;
}

.benefit {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-bottom: 4px;
    font-size: 0.85rem;
    color: #334155;
}

.benefit span {
    color: #10b981;
    font-weight: bold;
    font-size: 0.9rem;
}

/* TOUR SECTION */
.tour-section-compact {
    background: #fef9e7;
    border: 2px solid #ffc107;
    border-radius: 30px;
    padding: 6px 10px;
    margin: 8px 0;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 6px;
}

.tour-title {
    font-size: 0.8rem;
    font-weight: 600;
    color: #856404;
    margin: 0;
}

.tour-btn {
    background: #ffc107;
    color: #1e293b;
    border: none;
    padding: 5px 12px;
    border-radius: 30px;
    font-size: 0.8rem;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(255,193,7,0.3);
    white-space: nowrap;
    transition: all 0.2s;
}

.tour-btn:hover {
    background: #ffca2c;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(255,193,7,0.4);
}

.tour-btn:disabled {
    opacity: 0.7;
    cursor: not-allowed;
}

.tour-note {
    font-size: 0.65rem;
    color: #856404;
    margin: 0;
    width: 100%;
    text-align: center;
}

/* MAIN CTA BUTTON */
.btn-main-cta {
    background: #3b82f6;
    color: white;
    border: none;
    padding: 10px 14px;
    font-size: 0.95rem;
    font-weight: 600;
    border-radius: 40px;
    width: 100%;
    cursor: pointer;
    margin: 6px 0 2px 0;
    box-shadow: 0 4px 12px rgba(59,130,246,0.3);
    transition: all 0.2s;
}

.btn-main-cta:hover {
    background: #2563eb;
    transform: translateY(-2px);
}

.note {
    font-size: 0.65rem;
    color: #94a3b8;
    text-align: center;
    margin: 0;
    line-height: 1.2;
}

/* CONSTRUCTION BANNER */
.construction-banner {
    background: repeating-linear-gradient(
        45deg,
        #000000,
        #000000 20px,
        #ffd700 20px,
        #ffd700 40px
    );
    padding: 6px 10px;
    text-align: center;
    border-top: 2px solid #ffd700;
    flex-shrink: 0;
}

.construction-content {
    background: rgba(0,0,0,0.85);
    color: white;
    padding: 4px 10px;
    border-radius: 40px;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 0.7rem;
    font-weight: 600;
    border: 1px solid #ffd700;
    max-width: 100%;
    flex-wrap: wrap;
    justify-content: center;
}

.construction-icon {
    font-size: 0.8rem;
}

/* RESPONSIVE */
@media (max-width: 480px) {
    .compact-container {
        padding: 12px;
    }
    
    .compact-content {
        gap: 8px;
    }
    
    .compact-logo {
        width: 70px;
    }
    
    .logo-pulse {
        font-size: 3rem;
    }
    
    .compact-text h1 {
        font-size: 1.4rem;
    }
    
    .tour-section-compact {
        flex-direction: column;
        padding: 8px;
    }
    
    .tour-title {
        white-space: normal;
    }
    
    .tour-btn {
        width: 100%;
    }
}

@media (max-height: 700px) {
    .compact-container {
        padding: 10px;
    }
    
    .compact-logo {
        width: 60px;
    }
    
    .logo-pulse {
        font-size: 2.5rem;
    }
    
    .compact-text h1 {
        font-size: 1.3rem;
    }
    
    .benefit {
        margin-bottom: 2px;
        font-size: 0.8rem;
    }
    
    .tour-section-compact {
        margin: 4px 0;
        padding: 4px 8px;
    }
    
    .btn-main-cta {
        padding: 8px 12px;
        margin: 4px 0 2px;
        font-size: 0.9rem;
    }
}
</style>
{% endblock %}